<p>Using <span class="caps">IRB</span> to Drive Internet Explorer</p>

	<p>C:\Ruby\lib\ruby\site_ruby\1.8\cl>irb # Start the ruby interpreter, irb.  irb(main):001:0> # irb&#8217;s prompt&#8212;it is waiting for user input.  From here on, I&#8217;ll show the user input on the same line as the preceding irb prompt. irb(main):001:0> load &#8216;iec.rb&#8217; # User typed &#8220;load &#8216;iec.rb&#8217;&#8221;. Loads the <span class="caps">IE </span>Controller source file => true # Ruby reports the return value from the last command, in this case &#8220;load &#8216;iec.rb&#8217;&#8221;, then displays the irb prompt again irb(main):001:0> Dir.chdir &#8216;c:/wtr/scripting101/lab&#8217;# Change directory => 0# Ruby&#8217;s return value from Dir.chdir command irb(main):001:0> load &#8216;toolkit.rb&#8217; # Load the <span class="caps">WTR</span> toolkit => true # Return value from load irb(main):002:0> start_ie(&#8220;http://localhost:8080&#8221;) # Start the Internet Explorer browser at the given <span class="caps">URL</span>: the Timeclock login page => #<CLabs::IEC::ClIEController:0x32476f0 @auto_wrap_form=false, @ie=#<WIN32OLE:0x32476a8>, @options={:visible=>true}># Return value from start_ie: coded info about IE browser irb(main):003:0> show_forms # Show form actions on current page action: login# One form with action &#8216;login&#8217; => nil # No value returned by show_forms command irb(main):004:0> login_form = get_forms<sup><a href="#fn0">0</a></sup> # Assign first (and only, in this case) form on current page to variable name &#8216;login_form&#8217;.  Use variables for convenience and memory aids. => #<CLabs::IEC::IEDomFormWrapper:0x2b03d78 @form=#<WIN32OLE:0x2b03d90>> # Return value from get_forms<sup><a href="#fn0">0</a></sup>: coded info about form irb(main):005:0> show_elements(login_form) # List form elements (fields &#38; controls) name: name value: # Just 1 element (text field) named &#8216;name&#8217;, which is empty.  Note internal element name may not match displayed field label  => nil  irb(main):006:0> login_form.name = &#8220;brian&#8221; # Set value of &#8216;name&#8217; field.  Note appearance in IE => &#8220;brian&#8221;  irb(main):007:0> login_form.submit # Invoke action of login form (like hitting &#8216;enter&#8217; key); IE opens new page => nil  irb(main):008:0> show_forms # Show form actions on new page action: job # One form with action named &#8216;job&#8217; => nil  irb(main):009:0> job_form = get_forms<sup><a href="#fn0">0</a></sup> # Assign the form to variable &#8216;job_form&#8217; => #<CLabs::IEC::IEDomFormWrapper:0x2af2c78 @form=#<WIN32OLE:0x2af2c90>>     # Coded info from get_forms<sup><a href="#fn0">0</a></sup> irb(main):010:0> show_elements(job_form) # List form elements (controls) name: session value: 24199864 # (Hidden) element for session ID name: name value: # Empty (job) &#8216;name&#8217; (text) field name: background value: true # &#8216;background&#8217; (checkbox), currently checked => nil  irb(main):011:0> job_form.name = &#8220;misc&#8221; # Enter string in &#8216;name&#8217; text field  => nil  irb(main):012:0> job_form.submit # Submit form. The main timeclock page appears. => nil </p>

	<p>(continued)</p>

	<p>irb(main):013:0> show_forms # Show the form actions on current page. action: start_day # Action of zeroth form action: start # Action of first form action: job # Action of second form action: start # Action of third form.  Note two forms have the same action. Hmm. => nil  irb(main):014:0> start_form = get_form_by_action(&#8220;start&#8221;) #  Another way to pick a form: by action (instead of by index).  Uses the first form that matches the “start” action. => #<CLabs::IEC::IEDomFormWrapper:0x2adae40 @form=#<WIN32OLE:0x2adaea0>>  irb(main):015:0> show_elements(start_form) # What is the name of the “misc” button? name: session value: 24199864  name: name value: misc # (Button) name is “name”; value is “misc”. => nil  irb(main):016:0> get_element_by_value(start_form,&#8221;misc&#8221;).click # Select the button by its value, and click it.  IE updates text on page. => nil  irb(main):017:0> show_forms # What new forms have appeared? action: pause_or_stop_day  action: start  action: job  action: refresh  action: pause_or_stop_job  action: start  => nil  irb(main):018:0> refresh_form = get_form_by_action(&#8220;refresh&#8221;) => #<CLabs::IEC::IEDomFormWrapper:0x2acd448 @form=#<WIN32OLE:0x2acd4a8>>  irb(main):019:0> show_elements(refresh_form) # What is the button name? name: session value: 24199864  name: refresh value: Refresh  => nil  irb(main):020:0> refresh_form.elements(&#8220;refresh&#8221;).click # Select the button and click it.  Uses another way to select an element: by name.  IE updates the page content.  => nil </p>